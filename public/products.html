<!DOCTYPE html>
<html>
<head>
    <title>Productos - Belleza Eva</title>
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark">
    <div class="container">
        <a href="/" class="navbar-brand">Belleza Eva</a>
    </div>
</nav>

<div class="container mt-4">
    <h2 class="mb-4 text-center">Productos Disponibles</h2>

    <div id="productsList" class="row"></div>
</div>

<script>
fetch("http://127.0.0.1:8000/api/products")
.then(res => res.json())
.then(products => {
    let html = "";

    products.forEach(p => {
    html += `
    <div class="col-md-4 mb-3">
        <div class="card">

            <img src="${p.image_url || 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%23e0e0e0%22 width=%22400%22 height=%22300%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-family=%22Arial%22 font-size=%2220%22 fill=%22%23999%22%3EImagen del producto%3C/text%3E%3C/svg%3E'}" 
                 class="card-img-top" 
                 alt="Imagen del producto"
                 onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%23ffebee%22 width=%22400%22 height=%22300%22/%3E%3Ctext x=%2250%25%22 y=%2245%25%22 text-anchor=%22middle%22 font-family=%22Arial%22 font-size=%2218%22 fill=%22%23d32f2f%22%3E❌ Imagen no disponible%3C/text%3E%3Ctext x=%2250%25%22 y=%2255%25%22 text-anchor=%22middle%22 font-family=%22Arial%22 font-size=%2214%22 fill=%22%23d32f2f%22%3E(Error al cargar)%3C/text%3E%3C/svg%3E'"
                 style="height:250px; object-fit:cover;">

            <div class="card-body">
                <h5 class="card-title">${p.name}</h5>
                <p class="card-text">${p.description ?? ''}</p>
                <p class="fw-bold">$${p.price}</p>

                <a href="product.html?id=${p.id}" 
                   class="btn btn-primary w-100 mb-2">
                    Ver detalles
                </a>

                <button 
                    class="btn btn-outline-warning w-100"
                    onclick="addToFavorites(${p.id})">
                    ⭐ Agregar a Favoritos
                </button>
            </div>

        </div>
    </div>`;
});


    document.getElementById("productsList").innerHTML = html;
});

function addToFavorites(productId) {
    let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

    if (!favorites.includes(productId)) {
        favorites.push(productId);
        localStorage.setItem("favorites", JSON.stringify(favorites));
        alert("Producto agregado a favoritos ⭐");
    } else {
        alert("Este producto ya está en favoritos");
    }
}
</script>
  


</body>
</html>  