<!DOCTYPE html>
<html>
<head>
    <title>Carrito - Belleza Eva</title>
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet">
</head>

<body style="background-color:#fdf6f9;">

<nav class="navbar navbar-dark bg-dark">
    <div class="container">
        <a href="products.html" class="navbar-brand">‚Üê Volver a productos</a>
    </div>
</nav>

<div class="container mt-4">
    <h2 class="text-center mb-4">üõí Mi Carrito</h2>

    <div id="cartList" class="row"></div>

    <div class="text-center mt-4">
        <button class="btn btn-success btn-lg" onclick="checkout()">
            Finalizar compra
        </button>
    </div>
</div>

<script>
let cart = JSON.parse(localStorage.getItem("cart")) || [];

fetch("http://127.0.0.1:8000/api/products")
.then(res => res.json())
.then(products => {
    let html = "";
    let total = 0;

    cart.forEach(id => {
        let p = products.find(prod => prod.id === id);
        if (p) {
            total += parseFloat(p.price);
            html += `
            <div class="col-md-4 mb-3">
                <div class="card shadow-sm">
                    <img src="${p.image_url}" class="card-img-top" style="height:200px; object-fit:cover;">
                    <div class="card-body">
                        <h5>${p.name}</h5>
                        <p>$${p.price}</p>
                    </div>
                </div>
            </div>`;
        }
    });

    html += `<h4 class="text-center mt-3">Total: $${total.toFixed(2)}</h4>`;
    document.getElementById("cartList").innerHTML = html;
});

function checkout() {
    localStorage.removeItem("cart");
    alert("Compra realizada con √©xito üíñ");
    window.location.href = "products.html";
}
</script>

</body>
</html>
